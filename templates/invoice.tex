\documentclass[12pt]{article}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{tabularx}
\usepackage{graphicx}
\usepackage{array}
\usepackage{fancyhdr}
\usepackage{booktabs}
\usepackage[table]{xcolor}
\usepackage{colortbl}

% Header and footer setup
\pagestyle{fancy}
\fancyhf{}
\rhead{Invoice \#{{.Invoice.Number | escapeLatex}}}
\lhead{ {{.FromName}} }

\setlength{\parindent}{0pt}
\setlength{\parskip}{1em}

% Define colors for alternating rows
\definecolor{lightgray}{gray}{0.95}

% Remove extra spacing from booktabs in colored tables
\aboverulesep=0ex
\belowrulesep=0ex

\begin{document}

\begin{center}
    \Huge\bfseries Invoice
\end{center}

\vspace{1cm}

\textbf{From:}\\
{{.FromName}} \\
{{.FromAddress}} \\
{{.FromEmail}}

\vspace{0.5cm}

\textbf{To:}\\
{{.Invoice.ClientName | escapeLatex}} \\
{{.ClientAddress}} \\
{{range .ClientEmails}}{{. | escapeLatex}} \\
{{end}}

\vspace{0.5cm}

\textbf{Invoice Number:} {{.Invoice.Number | escapeLatex}} \\
\textbf{Date:} {{.InvoiceDate}} \\
\textbf{Due Date:} {{.DueDate}} \\

\vspace{1cm}

% Main invoice table with better formatting
\rowcolors{2}{white}{lightgray}
\begin{tabularx}{\textwidth}{>{\raggedright\arraybackslash}X r r r}
    \toprule
    \rowcolor{white}
    \textbf{Description} & \textbf{Quantity} & \textbf{Unit Price} & \textbf{Amount} \\
    \midrule
    {{range .Invoice.LineItems}}{{.Description | escapeLatex}} & {{printf "%.2f" .Quantity.InexactFloat64}} & \${{printf "%.2f" .UnitPrice.InexactFloat64}} & \${{printf "%.2f" .Total.InexactFloat64}} \\
    {{end}}
    \bottomrule
\end{tabularx}

\vspace{0.5cm}

% Summary section separated from main table
\begin{flushright}
\begin{tabular}{l r}
    \textbf{Subtotal:} & \${{printf "%.2f" .Invoice.Subtotal.InexactFloat64}} \\
    {{if .HasDiscount}}\textbf{Discount ({{printf "%.1f" .Invoice.DiscountRate.InexactFloat64}}\%):} & -\${{printf "%.2f" .Invoice.Discount.InexactFloat64}} \\{{end}}
    {{if .HasTax}}\textbf{Tax ({{printf "%.1f" .Invoice.TaxRate.InexactFloat64}}\%):} & \${{printf "%.2f" .Invoice.Tax.InexactFloat64}} \\{{end}}
    \midrule
    \textbf{Total Due:} & \textbf{\${{printf "%.2f" .Invoice.Total.InexactFloat64}}} \\
\end{tabular}
\end{flushright}

\vspace{1cm}

\textbf{Payment Instructions:} \\
{{if .PaymentMethods}}Please send payment using one of the following methods:\\
{{range .PaymentMethods}}\textbf{ {{.Type}}: } {{.Details}}\\
{{end}}{{else}}Please make payment to the account details provided separately.
{{end}}

\vfill

\centering
{\itshape Thank you for your business!}

\end{document}
